{"version":3,"sources":["webpack://sitecore/./spoiler-handler_rawscript.ts"],"names":["handleSpoilers","sps","document","getElementsByClassName","console","log","length","sp","imgs","getElementsByTagName","img","spoiler","tables","tb","lists","ul","elem","div","createElement","style","position","tagName","toLowerCase","a","parentElement","blockimg","url","getAttribute","tgt","removeChild","classList","add","insertBefore","addEventListener","contains","window","open","focus","par","btn","innerText","onclick","display","appendChild"],"mappings":"kGAAe,SAASA,IACpB,MAAMC,EAAMC,SAASC,uBAAuB,WAC5CC,QAAQC,IAAI,6BAA+BJ,EAAIK,OAAS,mBACxD,IAAK,MAAMC,KAAMN,EAAK,CAClB,MAAMO,EAAOD,EAAGE,qBAAqB,OACrC,IAAK,MAAMC,KAAOF,EACdG,EAAQD,GAEZ,MAAME,EAASL,EAAGE,qBAAqB,SACvC,IAAK,MAAMI,KAAMD,EACbD,EAAQE,GAEZ,MAAMC,EAAQP,EAAGE,qBAAqB,MACtC,IAAK,MAAMM,KAAMD,EACbH,EAAQI,IAIpB,SAASJ,EAAQK,GACb,MAAMC,EAAMf,SAASgB,cAAc,OAGnC,GAFAD,EAAIE,MAAMC,SAAW,WAEa,OAA9BJ,EAAKK,QAAQC,cAAwB,CACrC,MAAMC,EAAIP,EAAKQ,cACTC,EAAWF,EAAEC,cACbE,EAAMH,EAAEI,aAAa,QACrBC,EAAML,EAAEI,aAAa,UAC3BJ,EAAEM,YAAYb,GACdA,EAAKc,UAAUC,IAAI,iBACnBN,EAASO,aAAaf,EAAKM,GAC3BE,EAASI,YAAYN,GACrBP,EAAKiB,iBAAiB,SAAS,WACvBjB,EAAKc,UAAUI,SAAS,yBACxBC,OAAOC,KAAKV,EAAKE,GAAKS,eAI7B,CACD,MAAMC,EAAMtB,EAAKQ,cACjBR,EAAKc,UAAUC,IAAI,qBACnBO,EAAIN,aAAaf,EAAKD,GACtBsB,EAAIT,YAAYb,GAEpB,MAAMuB,EAAMrC,SAASgB,cAAc,UACnCqB,EAAIT,UAAUC,IAAI,kBAClBQ,EAAIC,UAAY,0BAChBD,EAAIE,QAAU,WACNzB,EAAKc,UAAUI,SAAS,iBACxBlB,EAAKc,UAAUC,IAAI,wBAEnBf,EAAKc,UAAUC,IAAI,4BACvBQ,EAAIpB,MAAMuB,QAAU,OACpBtC,QAAQC,IAAI,gBAAkBW,IAElCC,EAAI0B,YAAY3B,GAChBC,EAAI0B,YAAYJ,G","file":"323.bundle.js","sourcesContent":["export default function handleSpoilers() {\r\n    const sps = document.getElementsByClassName('spoiler');\r\n    console.log(\"Applying spoiler blurs to \" + sps.length + \" root elements.\");\r\n    for (const sp of sps) {\r\n        const imgs = sp.getElementsByTagName('img');\r\n        for (const img of imgs) {\r\n            spoiler(img);\r\n        }\r\n        const tables = sp.getElementsByTagName('table');\r\n        for (const tb of tables) {\r\n            spoiler(tb);\r\n        }\r\n        const lists = sp.getElementsByTagName('ul');\r\n        for (const ul of lists) {\r\n            spoiler(ul);\r\n        }\r\n    }\r\n}\r\nfunction spoiler(elem) {\r\n    const div = document.createElement(\"div\");\r\n    div.style.position = \"relative\";\r\n    //div.style.overflow = \"hidden\";\r\n    if (elem.tagName.toLowerCase() == \"img\") {\r\n        const a = elem.parentElement;\r\n        const blockimg = a.parentElement;\r\n        const url = a.getAttribute(\"href\");\r\n        const tgt = a.getAttribute(\"target\");\r\n        a.removeChild(elem);\r\n        elem.classList.add(\"spoiler-image\");\r\n        blockimg.insertBefore(div, a);\r\n        blockimg.removeChild(a);\r\n        elem.addEventListener('click', function () {\r\n            if (elem.classList.contains(\"spoiler-image-reveal\")) {\r\n                window.open(url, tgt).focus();\r\n            }\r\n        });\r\n    }\r\n    else {\r\n        const par = elem.parentElement;\r\n        elem.classList.add(\"spoilered-element\");\r\n        par.insertBefore(div, elem);\r\n        par.removeChild(elem);\r\n    }\r\n    const btn = document.createElement(\"button\");\r\n    btn.classList.add(\"spoiler-button\");\r\n    btn.innerText = \"Click to Reveal Spoiler\";\r\n    btn.onclick = function () {\r\n        if (elem.classList.contains(\"spoiler-image\"))\r\n            elem.classList.add(\"spoiler-image-reveal\");\r\n        else\r\n            elem.classList.add(\"spoilered-element-reveal\");\r\n        btn.style.display = \"none\";\r\n        console.log(\"Unspoilering \" + elem);\r\n    };\r\n    div.appendChild(elem);\r\n    div.appendChild(btn);\r\n    /*\r\n    const div = document.createElement(\"div\");\r\n    div.classList.add(\"text-overlay\");\r\n    elem.after(div);\r\n    elem.parentElement!.style.position = \"relative\";\r\n    elem.parentElement!.style.textAlign = \"center\";\r\n    elem.addEventListener('click', function(ev:MouseEvent) {\r\n        const div:HTMLElement = <HTMLElement>elem.nextElementSibling;\r\n        if (elem.classList.contains(\"spoiler-image\")) {\r\n            elem.classList.remove(\"spoiler-image\");\r\n            div.style.display = \"none\";\r\n            console.log(\"Unspoilering \"+elem);\r\n        }\r\n        else {\r\n            elem.classList.add(\"spoiler-image\");\r\n            div.style.display = \"block\";\r\n            console.log(\"Re-spoilering \"+elem);\r\n        }\r\n        ev.stopPropagation();\r\n        ev.cancelBubble = true;\r\n    });*/\r\n}\r\n"],"sourceRoot":""}