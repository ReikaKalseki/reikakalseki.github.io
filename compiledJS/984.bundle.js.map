{"version":3,"sources":["webpack://sitecore/./node_modules/ts-debounce/dist/src/index.esm.js","webpack://sitecore/./browser.ts","webpack://sitecore/./library.ts","webpack://sitecore/./se/backgroundgen.ts"],"names":["r","e","n","i","t","o","a","isImmediate","u","callback","c","maxWait","v","Date","now","l","f","d","slice","call","arguments","this","Promise","clearTimeout","setTimeout","apply","forEach","resolve","push","reject","cancel","isPhone","document","addEventListener","console","log","imgs","getElementsByClassName","length","img","par","parentNode","tagName","put","createElement","innerHTML","src","replaceChild","className","url","replace","text","style","width","header","navbar","getElementById","insertBefore","nextSibling","toc","removeChild","collapseOnPhone","root","date","time","getSeconds","month","getMonth","day","getDate","xmas","hallow","viskey","visval","xkey","ykey","hkey","wkey","tileWidth","tileHeight","tileWidthNum","tileHeightNum","imagePaths","getRandomBetween","min","max","Math","floor","random","getRandomDecimalBetween","getOrCreateImgPath","folder","folderName","ret","window","location","href","idx","indexOf","levels","substring","split","getImageRoot","getTileWidth","iw","toString","getTileHeight","ih","getArrayIndex","cols","x","y","STARFIELD_SIZE","addImage","elem","ix","iy","svgimg","createElementNS","setAttributeNS","appendChild","isTransparent","modifyImageLocational","rows","cos","sin","getRandomFunctionalBlock","k","image","cargo","index","sides","placeRoom","front","back","points","w","h","edge","abs","px","entry","putConveyorAt","type","startsWith","tryConnectConveyor","p1","p2","corner","setPageBackground","body","html","documentElement","height","scrollHeight","offsetHeight","clientHeight","titleImg","rh","innerHeight","rw","innerWidth","clientWidth","ceil","tw","th","Array","idxl","idxr","idxu","idxd","idxld","idxrd","makeHalls","wrapInArmor","makeConveyors","imgw","imgh","buildImage","tag","container","id","prepend","firstChild"],"mappings":"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","file":"984.bundle.js","sourcesContent":["function r(r,e,n){var i,t,o;void 0===e&&(e=50),void 0===n&&(n={});var a=null!=(i=n.isImmediate)&&i,u=null!=(t=n.callback)&&t,c=n.maxWait,v=Date.now(),l=[];function f(){if(void 0!==c){var r=Date.now()-v;if(r+e>=c)return c-r}return e}var d=function(){var e=[].slice.call(arguments),n=this;return new Promise(function(i,t){var c=a&&void 0===o;if(void 0!==o&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,v=Date.now(),!a){var i=r.apply(n,e);u&&u(i),l.forEach(function(r){return(0,r.resolve)(i)}),l=[]}},f()),c){var d=r.apply(n,e);return u&&u(d),i(d)}l.push({resolve:i,reject:t})})};return d.cancel=function(r){void 0!==o&&clearTimeout(o),l.forEach(function(e){return(0,e.reject)(r)}),l=[]},d}export{r as debounce};\n//# sourceMappingURL=index.esm.js.map\n","export const isPhone = checkMobile();\r\nfunction checkMobile() {\r\n    return false;\r\n}\r\nfunction collapseOnPhone() {\r\n    if (isPhone) {\r\n        var imgs = document.getElementsByClassName(\"deembed-media\");\r\n        while (imgs.length > 0) {\r\n            let img = imgs[0];\r\n            let par = img.parentNode;\r\n            //console.log(img.src+\" @ \"+par.tagName);\r\n            if (par.tagName == \"VIDEO\") {\r\n                let put = document.createElement(\"div\");\r\n                put.innerHTML = '<a href = \"' + img.src + '\">' + img.src + \"</a>\";\r\n                par.parentNode.replaceChild(put, par);\r\n            }\r\n            else {\r\n                //par.replaceChild(put, img);\r\n                if (par.className == \"video\") {\r\n                    var url = img.src.replace(\"embed/\", \"watch?v=\");\r\n                    par.innerHTML = '<a href = \"' + url + '\">' + url + \"</a>\";\r\n                }\r\n                else if (par.className != \"header-image\")\r\n                    par.innerHTML = img.src + \"<br>\";\r\n                else\r\n                    par.innerHTML = \"\";\r\n            }\r\n            console.log(\"Hiding media '\" + img.src + \"'\");\r\n        }\r\n        var text = document.getElementsByClassName(\"textarea\");\r\n        for (var i = 0; i < text.length; i++) {\r\n            text[i].style.width = \"33%\";\r\n        }\r\n        let header = document.createElement(\"div\");\r\n        header.innerHTML = \"<div style = 'text-align: center; width: 33%; margin: auto; border: 3px solid red;'><h2 style = 'color: red; margin: 12px;'>This site is not designed for use on phones and other handheld devices, nor is any of its content relevant on such platforms. You may continue to browse it this way if you wish, but it is recommended that you visit the site with a proper computer.</h2></div>\";\r\n        let navbar = document.getElementById(\"navbar\");\r\n        navbar.parentNode.insertBefore(header, navbar.nextSibling);\r\n        let toc = document.getElementById(\"toc_container\");\r\n        toc.parentNode.removeChild(toc);\r\n    }\r\n}\r\nfunction interceptDOM() {\r\n    console.log(\"Detected phone browser: \" + isPhone);\r\n    collapseOnPhone();\r\n}\r\ndocument.addEventListener(\"DOMContentLoaded\", interceptDOM);\r\n","let root = {};\r\nexport const date = new Date(); //new Date(\"December 16, 2016 11:13:00\");//\r\nexport const time = date.getSeconds();\r\nexport const month = date.getMonth();\r\nexport const day = date.getDate();\r\nexport const xmas = month == 11 || (month == 0 && day <= 10); //between dec 1 and jan 10\r\nexport const hallow = month == 9 && day >= 10; //between oct 10 and oct 31\t\r\nexport const viskey = 'visibility';\r\nexport const visval = 'visible';\r\nexport const xkey = 'x';\r\nexport const ykey = 'y';\r\nexport const hkey = 'height';\r\nexport const wkey = 'width';\r\nlet tileWidthNum = -1;\r\nlet tileHeightNum = -1;\r\nlet tileWidth;\r\nlet tileHeight;\r\nlet imagePaths = {};\r\nexport function absDiff(a, b) {\r\n    return Math.abs(Math.abs(a) - Math.abs(b));\r\n}\r\nexport function getImageRoot(folderName) {\r\n    if (root[folderName] == null || typeof (root[folderName]) == \"undefined\") {\r\n        var ret = \"images/\" + folderName + \"/\";\r\n        var url = window.location.href;\r\n        //console.log(url);\r\n        var idx = url.indexOf(\"sitecore\");\r\n        url = url.substring(idx + 9);\r\n        //console.log(url);\r\n        var levels = url.split(\"/\").length - 1;\r\n        for (var i = 0; i < levels; i++)\r\n            ret = \"../\" + ret;\r\n        root[folderName] = ret;\r\n        //console.log(\"Calculated root \"+root[folderName]);\r\n    }\r\n    return root[folderName];\r\n}\r\nexport function getRandomBetween(min, max) {\r\n    return Math.floor(Math.random() * (max - min + 1) + min);\r\n}\r\nexport function getRandomDecimalBetween(min, max) {\r\n    return Math.random() * (max - min) + min;\r\n}\r\nexport function getOrCreateImgPath(img, folder) {\r\n    if (imagePaths[img] == null) {\r\n        imagePaths[img] = getImageRoot(folder) + img + \".png\";\r\n        //console.log(\"Computed image path '\"+imagePaths[img]+\"' for image '\"+img+\"'\");\r\n    }\r\n    return imagePaths[img];\r\n}\r\nexport function getTileWidth(iw) {\r\n    if (tileWidthNum != iw) {\r\n        tileWidthNum = iw;\r\n        tileWidth = tileWidthNum.toString();\r\n    }\r\n    return tileWidth;\r\n}\r\nexport function getTileHeight(ih) {\r\n    if (tileHeightNum != ih) {\r\n        tileHeightNum = ih;\r\n        tileHeight = tileHeightNum.toString();\r\n    }\r\n    return tileHeight;\r\n}\r\nexport function getArrayIndex(cols, x, y) {\r\n    return x + y * cols;\r\n}\r\n","const SCALE = 1;\r\nconst STARFIELD_SIZE = 2000;\r\nimport { debounce } from \"ts-debounce\";\r\nimport { xmas, hallow, viskey, visval, xkey, ykey, hkey, wkey, getRandomBetween, getOrCreateImgPath, getTileWidth, getTileHeight, getArrayIndex } from '../library';\r\nimport { isPhone } from '../browser';\r\nfunction addImage(elem, img, ix, iy, iw, ih) {\r\n    //var pre = '<image x=\"'+ix+'\" y=\"'+iy+'\" width=\"'+iw+'\" height=\"'+ih+'\" xlink:href=\"'+getImageRoot();\r\n    //var post = '.png\" />';\r\n    //return pre+img+post;\r\n    var svgimg = document.createElementNS('http://www.w3.org/2000/svg', 'image');\r\n    svgimg.setAttributeNS(null, wkey, getTileWidth(iw));\r\n    svgimg.setAttributeNS(null, hkey, getTileHeight(ih));\r\n    svgimg.setAttributeNS('http://www.w3.org/1999/xlink', 'href', getOrCreateImgPath(img, \"se\"));\r\n    svgimg.setAttributeNS(null, xkey, ix.toString());\r\n    svgimg.setAttributeNS(null, ykey, iy.toString());\r\n    svgimg.setAttributeNS(null, viskey, visval);\r\n    elem.appendChild(svgimg);\r\n}\r\nfunction buildImage(elem, rows, cols, front, back, imgw, imgh) {\r\n    var w = 64 * SCALE;\r\n    var h = 64 * SCALE;\r\n    var x = 0;\r\n    var y = 0;\r\n    if (xmas) {\r\n        var svgimg = document.createElementNS('http://www.w3.org/2000/svg', 'image');\r\n        svgimg.setAttributeNS(null, wkey, \"320\");\r\n        svgimg.setAttributeNS(null, hkey, \"320\");\r\n        svgimg.setAttributeNS('http://www.w3.org/1999/xlink', 'href', getOrCreateImgPath(\"xmas\", \"se\"));\r\n        svgimg.setAttributeNS(null, xkey, getRandomBetween(32, imgw - 350).toString());\r\n        svgimg.setAttributeNS(null, ykey, getRandomBetween(32, imgw - 350).toString());\r\n        svgimg.setAttributeNS(null, viskey, visval);\r\n        elem.appendChild(svgimg);\r\n    }\r\n    if (hallow) {\r\n        var svgimg = document.createElementNS('http://www.w3.org/2000/svg', 'image');\r\n        svgimg.setAttributeNS(null, wkey, \"320\");\r\n        svgimg.setAttributeNS(null, hkey, \"320\");\r\n        svgimg.setAttributeNS('http://www.w3.org/1999/xlink', 'href', getOrCreateImgPath(\"hallow\", \"se\"));\r\n        svgimg.setAttributeNS(null, xkey, getRandomBetween(32, imgw - 350).toString());\r\n        svgimg.setAttributeNS(null, ykey, getRandomBetween(32, imgw - 350).toString());\r\n        svgimg.setAttributeNS(null, viskey, visval);\r\n        elem.appendChild(svgimg);\r\n    }\r\n    for (var k = 0; k < rows; k++) {\r\n        x = 0;\r\n        for (var i = 0; i < cols; i++) {\r\n            var idx = getArrayIndex(cols, i, k);\r\n            var img = front[idx];\r\n            if (isTransparent(img) && back[idx] != \"sky\") {\r\n                var bimg = modifyImageLocational(rows, cols, i, k, idx, back[idx]);\r\n                addImage(elem, bimg, x, y, w, h);\r\n            }\r\n            if (img != \"air\") {\r\n                //console.log(\"Got \"+img+\" @ \"+i+\", \"+k);\r\n                if (back[idx] != \"sky\")\r\n                    addImage(elem, \"inner\", x, y, w, h);\r\n                if (img != \"inner\") {\r\n                    img = modifyImageLocational(rows, cols, i, k, idx, img);\r\n                    addImage(elem, img, x, y, w, h);\r\n                }\r\n            }\r\n            x += w;\r\n        }\r\n        y += h;\r\n    }\r\n}\r\nfunction isTransparent(img) {\r\n    switch (img) {\r\n        case \"air\":\r\n        case \"gravgen\":\r\n        case \"conv_v\":\r\n        case \"conv_h\":\r\n        case \"convcorner-dl\":\r\n        case \"convcorner-ul\":\r\n        case \"convcorner-dr\":\r\n        case \"convcorner-ur\":\r\n        case \"prog\":\r\n        case \"inner\":\r\n            return true;\r\n        default:\r\n            return false;\r\n    }\r\n}\r\nfunction modifyImageLocational(rows, cols, x, y, idx, img) {\r\n    if (img == \"armor\") {\r\n        if (xmas) {\r\n            var v = Math.cos(x * 0.25) + Math.cos(x * 0.75) * 0.43 - Math.sin(y * 0.47) * 0.72;\r\n            img = v > 0 ? \"armor_green\" : \"armor_red\";\r\n        }\r\n        if (hallow) {\r\n            var v = Math.cos(x * 0.25) + Math.cos(x * 0.75) * 0.43 - Math.sin(y * 0.47) * 0.72;\r\n            img = v > 0 ? \"armor_black\" : \"armor_orange\";\r\n        }\r\n    }\r\n    return img;\r\n}\r\nfunction getRandomFunctionalBlock(i, k, idx) {\r\n    var f = Math.random() * 1.5;\r\n    var entry = null;\r\n    if (f < 0.05) {\r\n        entry = { image: \"gravgen\", cargo: false, x: i, y: k, index: idx, sides: [\"l\", \"r\", \"u\", \"d\"] };\r\n    }\r\n    else if (f < 0.15) {\r\n        entry = { image: \"assembler_b\", cargo: true, x: i, y: k, index: idx, sides: [\"l\", \"r\", \"d\"] };\r\n    }\r\n    else if (f < 0.25) {\r\n        entry = { image: \"timer\", cargo: false, x: i, y: k, index: idx, sides: [\"l\", \"r\", \"u\", \"d\"] };\r\n    }\r\n    else if (f < 0.4) {\r\n        entry = { image: \"battery\", cargo: false, x: i, y: k, index: idx, sides: [\"l\", \"r\", \"u\", \"d\"] };\r\n    }\r\n    else if (f < 0.5) {\r\n        entry = { image: \"prog\", cargo: false, x: i, y: k, index: idx, sides: [\"l\", \"r\", \"u\", \"d\"] };\r\n    }\r\n    else if (f < 0.75) {\r\n        entry = { image: \"catwalk\", cargo: false, x: i, y: k, index: idx, sides: [\"l\", \"r\", \"u\", \"d\"] };\r\n    }\r\n    else if (f < 0.8) {\r\n        entry = { image: \"door\", cargo: false, x: i, y: k, index: idx, sides: [\"l\", \"r\", \"u\", \"d\"] };\r\n    }\r\n    else if (f < 0.9) {\r\n        entry = { image: \"cent\", cargo: true, x: i, y: k, index: idx, sides: [\"u\", \"d\"] };\r\n    }\r\n    else if (f < 1.1) {\r\n        entry = { image: \"blast_b\", cargo: true, x: i, y: k, index: idx, sides: [\"d\"] };\r\n    }\r\n    else if (f < 1.3) {\r\n        entry = { image: \"stone_br\", cargo: true, x: i, y: k, index: idx, sides: [\"d\", \"r\"] };\r\n    }\r\n    else {\r\n        entry = { image: \"cargo\", cargo: true, x: i, y: k, index: idx, sides: [\"l\", \"r\", \"u\", \"d\"] };\r\n    }\r\n    return entry;\r\n}\r\nfunction placeRoom(x, y, rows, cols, front, back, points) {\r\n    var w = getRandomBetween(2, 4);\r\n    var h = getRandomBetween(4, 5);\r\n    for (var k = 0; k < h; k++) {\r\n        for (var i = -w; i <= w; i++) {\r\n            var idx = getArrayIndex(cols, x + i, y + k);\r\n            var edge = (Math.abs(i) == w || k == 0 || k == h - 1); // && (k != h-2 || back[idx] != \"interiorwall\");\r\n            front[idx] = edge ? \"interiorwall\" : \"inner\";\r\n            back[idx] = \"interiorwall\";\r\n        }\r\n    }\r\n    var n = getRandomBetween(2, w * 2 - 1);\r\n    for (var i = 0; i < n; i++) {\r\n        var px = getRandomBetween(x - w, x + w);\r\n        var idx = getArrayIndex(cols, px, y + h - 2);\r\n        if (front[idx] != \"inner\" && front[idx] != \"interiorwall\" && front[idx] != \"air\")\r\n            continue;\r\n        var entry = getRandomFunctionalBlock(px, y + h - 2, idx);\r\n        front[idx] = entry.image;\r\n        if (front[idx] == \"assembler_b\") {\r\n            front[getArrayIndex(cols, px, y + h - 3)] = \"assembler_t\";\r\n        }\r\n        if (front[idx] == \"blast_b\") {\r\n            front[getArrayIndex(cols, px, y + h - 3)] = \"blast_t\";\r\n        }\r\n        if (front[idx] == \"stone_br\") {\r\n            front[getArrayIndex(cols, px, y + h - 3)] = \"stone_tr\";\r\n            front[getArrayIndex(cols, px - 1, y + h - 3)] = \"stone_tl\";\r\n            front[getArrayIndex(cols, px - 1, y + h - 2)] = \"stone_bl\";\r\n        }\r\n        if (entry.cargo)\r\n            points.push(entry);\r\n    }\r\n}\r\nfunction putConveyorAt(rows, cols, front, back, idx, type) {\r\n    if (back[idx] == \"armor\" || back[idx] == \"interiorwall\" || back[idx] == \"sky\" || back[idx] == \"cargo\") {\r\n        if (back[idx] == \"cargo\" || front[idx] == \"cargo\" || front[idx].startsWith(\"conv\"))\r\n            type = \"cargo\";\r\n        front[idx] = (back[idx] == \"armor\") ? \"cargo\" : type;\r\n    }\r\n}\r\nfunction tryConnectConveyor(rows, cols, front, back, p1, p2) {\r\n    //console.log(\"Connecting \"+p1.x+\",\"+p1.y+\" -> \"+p2.x+\",\"+p2.y);\r\n    for (var i = Math.min(p1.x, p2.x) + 1; i < Math.max(p1.x, p2.x); i++) {\r\n        putConveyorAt(rows, cols, front, back, getArrayIndex(cols, i, p1.y), \"conv_h\");\r\n    }\r\n    for (var i = Math.min(p1.y, p2.y) + 1; i < Math.max(p1.y, p2.y); i++) {\r\n        putConveyorAt(rows, cols, front, back, getArrayIndex(cols, p2.x, i), \"conv_v\");\r\n    }\r\n    var corner = \"convcorner\";\r\n    if (p2.y < p1.y) {\r\n        if (p2.x < p1.x) {\r\n            corner = \"convcorner-ur\";\r\n        }\r\n        else {\r\n            corner = \"convcorner-ul\";\r\n        }\r\n    }\r\n    else {\r\n        if (p2.x < p1.x) {\r\n            corner = \"convcorner-dr\";\r\n        }\r\n        else {\r\n            corner = \"convcorner-dl\";\r\n        }\r\n    }\r\n    putConveyorAt(rows, cols, front, back, getArrayIndex(cols, p2.x, p1.y), corner);\r\n}\r\nfunction makeConveyors(rows, cols, front, back, points) {\r\n    for (var k = 0; k < rows; k++) {\r\n        for (var i = 0; i < cols; i++) {\r\n            if (Math.random() < 0.2) {\r\n                var idx = getArrayIndex(cols, i, k);\r\n                if (back[idx] == \"interiorwall\" && front[idx] == \"inner\") {\r\n                    var idxd = getArrayIndex(cols, i, k + 1);\r\n                    if (front[idxd] == \"interiorwall\") {\r\n                        back[idx] = \"cargo\";\r\n                        //var entry = {x:i, y:k, index:getArrayIndex(cols, i, k), sides:[\"l\", \"r\", \"u\", \"d\"]};\r\n                        //points.push(entry);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (points.length >= 2) {\r\n        for (var i = 0; i < Math.max(1, points.length / 3); i++) {\r\n            var p1 = points[getRandomBetween(0, points.length - 1)];\r\n            var p2 = points[getRandomBetween(0, points.length - 1)];\r\n            tryConnectConveyor(rows, cols, front, back, p1, p2);\r\n        }\r\n    }\r\n    //for (var i = 0; k < points.length; i++) {\r\n    //\tvar entry = points[i];\r\n    //}\r\n    for (var k = 0; k < rows; k++) {\r\n        for (var i = 0; i < cols; i++) {\r\n            var idx = getArrayIndex(cols, i, k);\r\n            /*\r\n                    if (front[idx] == \"conv_h\" || front[idx] == \"conv_v\" || front[idx].startsWith(\"convcorner\")) {\r\n                        var c = 0;\r\n                        if (front[getArrayIndex(cols, i+1, k)] == \"conv_h\" || front[getArrayIndex(cols, i+1, k)] == \"assembler_b\")\r\n                            c++;\r\n                        if (front[getArrayIndex(cols, i-1, k)] == \"conv_h\" || front[getArrayIndex(cols, i-1, k)] == \"assembler_b\")\r\n                            c++;\r\n                        if (front[getArrayIndex(cols, i, k-1)] == \"conv_v\" || front[getArrayIndex(cols, i, k-1)] == \"assembler_b\")\r\n                            c++;\r\n                        if (front[getArrayIndex(cols, i, k+1)] == \"conv_v\" || front[getArrayIndex(cols, i, k+1)] == \"assembler_t\")\r\n                            c++;\r\n                        if (c >= 3) {\r\n                            front[idx] = \"cargo\";\r\n                        }\r\n                    }\r\n                    else\r\n            */ if (front[idx] == \"assembler_b\") {\r\n                front[getArrayIndex(cols, i, k - 1)] = \"assembler_t\";\r\n            }\r\n            else if (front[idx] == \"assembler_t\") {\r\n                front[getArrayIndex(cols, i, k + 1)] = \"assembler_b\";\r\n            }\r\n            if (front[idx] == \"blast_b\") {\r\n                front[getArrayIndex(cols, i, k - 1)] = \"blast_t\";\r\n            }\r\n            else if (front[idx] == \"blast_t\") {\r\n                front[getArrayIndex(cols, i, k + 1)] = \"blast_b\";\r\n            }\r\n            if (front[idx] == \"stone_br\") {\r\n                front[getArrayIndex(cols, i, k - 1)] = \"stone_tr\";\r\n                front[getArrayIndex(cols, i - 1, k - 1)] = \"stone_tl\";\r\n                front[getArrayIndex(cols, i - 1, k)] = \"stone_bl\";\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction makeHalls(rows, cols, front, back) {\r\n    for (var k = 0; k < rows; k++) {\r\n        for (var i = 0; i < cols; i++) {\r\n            var idx = getArrayIndex(cols, i, k);\r\n            if (front[idx] == \"interiorwall\") {\r\n                var idxl = getArrayIndex(cols, i - 1, k);\r\n                var idxr = getArrayIndex(cols, i + 1, k);\r\n                var idxu = getArrayIndex(cols, i, k - 1);\r\n                var idxd = getArrayIndex(cols, i, k + 1);\r\n                if (front[idxu] == \"interiorwall\" && front[idxd] == \"interiorwall\" && front[idxl] == \"inner\" && back[idxr] == \"inner\") {\r\n                    var idxld = getArrayIndex(cols, i - 1, k + 1);\r\n                    var idxrd = getArrayIndex(cols, i + 1, k + 1);\r\n                    if (front[idxld] == \"interiorwall\" && front[idxrd] == \"interiorwall\") {\r\n                        front[idx] = \"inner\";\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction wrapInArmor(rows, cols, front, back) {\r\n    for (var k = 0; k < rows; k++) {\r\n        for (var i = 0; i < cols; i++) {\r\n            var idx = getArrayIndex(cols, i, k);\r\n            if (back[idx] == \"sky\") {\r\n                var idxl = getArrayIndex(cols, i - 1, k);\r\n                var idxr = getArrayIndex(cols, i + 1, k);\r\n                var idxu = getArrayIndex(cols, i, k - 1);\r\n                var idxd = getArrayIndex(cols, i, k + 1);\r\n                if (back[idxu] == \"interiorwall\" || back[idxd] == \"interiorwall\" || back[idxl] == \"interiorwall\" || back[idxr] == \"interiorwall\") {\r\n                    back[idx] = \"armor\";\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nexport default function setPageBackground() {\r\n    if (isPhone)\r\n        return;\r\n    let tail = '</svg>';\r\n    let w = 64 * SCALE;\r\n    let h = 64 * SCALE;\r\n    let x = 0;\r\n    let y = 0;\r\n    //var height = findHighestNode(0, document.documentElement.childNodes);\r\n    let body = document.body;\r\n    let html = document.documentElement;\r\n    let height = Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight) - 64;\r\n    let titleImg = document.getElementsByClassName(\"title-image\")[0];\r\n    if (titleImg == null || titleImg.src == null || titleImg.src == \"\" || titleImg.src == window.location.href) {\r\n        height += 72;\r\n    }\r\n    else {\r\n        height += 48;\r\n    }\r\n    //console.log(\"Total height is \"+height+\", document content is: \"+document.documentElement.innerHTML);\r\n    let rh = Math.max(height, window.innerHeight, document.body.clientHeight);\r\n    let rw = Math.max(window.innerWidth, document.body.clientWidth);\r\n    //console.log(rw+\" x \"+rh);\r\n    let rows = Math.ceil(rh / h);\r\n    let cols = Math.ceil(rw / w);\r\n    let tw = cols * w;\r\n    let th = rows * h;\r\n    console.log(\"Generating SE tileset with \" + cols + \" columns and \" + rows + \" rows\");\r\n    let xmlns = \"http://www.w3.org/2000/svg\";\r\n    let elem = document.createElementNS(xmlns, \"svg\");\r\n    elem.setAttributeNS(null, \"width\", tw.toString());\r\n    elem.setAttributeNS(null, \"height\", th.toString());\r\n    for (var i = 0; i < rw; i += STARFIELD_SIZE) {\r\n        for (var k = 0; k < rh; k += STARFIELD_SIZE) {\r\n            addImage(elem, \"starfield\", i, k, STARFIELD_SIZE, STARFIELD_SIZE);\r\n        }\r\n    }\r\n    let back = new Array(cols * rows);\r\n    let front = new Array(cols * rows);\r\n    for (var k = 0; k < rows; k++) {\r\n        for (var i = 0; i < cols; i++) {\r\n            var idx = getArrayIndex(cols, i, k);\r\n            back[idx] = \"sky\";\r\n            front[idx] = \"air\";\r\n        }\r\n    }\r\n    let points = [];\r\n    for (var k = 0; k < rows * 0.75; k++) {\r\n        placeRoom(getRandomBetween(4, cols - 4), getRandomBetween(2, rows - 2), rows, cols, front, back, points);\r\n    }\r\n    makeHalls(rows, cols, front, back);\r\n    wrapInArmor(rows, cols, front, back);\r\n    makeConveyors(rows, cols, front, back, points);\r\n    buildImage(elem, rows, cols, front, back, rw, rh);\r\n    let tag = \"background-content\";\r\n    let container = document.getElementById(tag);\r\n    if (container == null) {\r\n        container = document.createElement(\"div\");\r\n        container.id = tag;\r\n        console.log(\"Injecting background element.\");\r\n        document.body.prepend(container);\r\n    }\r\n    while (container.firstChild) {\r\n        container.removeChild(container.firstChild);\r\n    }\r\n    //console.log(elem);\r\n    container.appendChild(elem);\r\n}\r\nwindow.addEventListener('resize', debounce(setPageBackground, 250, { isImmediate: true }));\r\n"],"sourceRoot":""}