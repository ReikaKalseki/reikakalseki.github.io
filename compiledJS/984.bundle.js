(self.webpackChunksitecore=self.webpackChunksitecore||[]).push([[984],{938:(e,t,r)=>{"use strict";function n(e,t,r){var n,i,a;void 0===t&&(t=50),void 0===r&&(r={});var o=null!=(n=r.isImmediate)&&n,l=null!=(i=r.callback)&&i,s=r.maxWait,c=Date.now(),d=[];function u(){if(void 0!==s){var e=Date.now()-c;if(e+t>=s)return s-e}return t}var g=function(){var t=[].slice.call(arguments),r=this;return new Promise((function(n,i){var s=o&&void 0===a;if(void 0!==a&&clearTimeout(a),a=setTimeout((function(){if(a=void 0,c=Date.now(),!o){var n=e.apply(r,t);l&&l(n),d.forEach((function(e){return(0,e.resolve)(n)})),d=[]}}),u()),s){var g=e.apply(r,t);return l&&l(g),n(g)}d.push({resolve:n,reject:i})}))};return g.cancel=function(e){void 0!==a&&clearTimeout(a),d.forEach((function(t){return(0,t.reject)(e)})),d=[]},g}r.d(t,{D:()=>n})},984:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var n=r(938),i=r(621),a=r(212);const o=2e3;function l(e,t){let r=document.createElement("div");return r.className="tile-se-"+t,e.appendChild(r),r}function s(e,t,r,n,a,o){t=d(r,n,t);var l=document.createElementNS("http://www.w3.org/2000/svg","image");l.setAttributeNS(null,i.yJ,a.toString()),l.setAttributeNS(null,i.eT,o.toString()),l.setAttributeNS("http://www.w3.org/1999/xlink","href",(0,i.Fq)(t,"se")),l.setAttributeNS(null,i.HP,r.toString()),l.setAttributeNS(null,i.rR,n.toString()),l.setAttributeNS(null,i.pX,i.yK),e.appendChild(l)}function c(e){switch(e){case"air":case"gravgen":case"conv_v":case"conv_h":case"convcorner-dl":case"convcorner-ul":case"convcorner-dr":case"convcorner-ur":case"prog":case"inner":return!0;default:return!1}}function d(e,t,r){return"armor"==r?(i.hm&&(r=Math.cos(.25*e)+.43*Math.cos(.75*e)-.72*Math.sin(.47*t)>0?"armor_green":"armor_red"),i.Jt&&(r=Math.cos(.25*e)+.43*Math.cos(.75*e)-.72*Math.sin(.47*t)>0?"armor_black":"armor_orange")):"conv_h"==r&&Math.random()<.05&&(r=Math.random()<.5?"sorter-l":"sorter-r"),r}function u(e,t,r){var n=1.5*Math.random();return n<.05?{image:"gravgen",cargo:!1,x:e,y:t,index:r,sides:["l","r","u","d"]}:n<.15?{image:"assembler_b",cargo:!0,x:e,y:t,index:r,sides:["l","r","d"]}:n<.25?{image:"timer",cargo:!1,x:e,y:t,index:r,sides:["l","r","u","d"]}:n<.4?{image:"battery",cargo:!1,x:e,y:t,index:r,sides:["l","r","u","d"]}:n<.5?{image:"prog",cargo:!1,x:e,y:t,index:r,sides:["l","r","u","d"]}:n<.75?{image:"catwalk",cargo:!1,x:e,y:t,index:r,sides:["l","r","u","d"]}:n<.8?{image:"door",cargo:!1,x:e,y:t,index:r,sides:["l","r","u","d"]}:n<.9?{image:"cent",cargo:!0,x:e,y:t,index:r,sides:["u","d"]}:n<1.1?{image:"blast_b",cargo:!0,x:e,y:t,index:r,sides:["d"]}:n<1.3?{image:"stone_br",cargo:!0,x:e,y:t,index:r,sides:["d","r"]}:{image:"cargo",cargo:!0,x:e,y:t,index:r,sides:["l","r","u","d"]}}function g(e,t,r,n,a,o,l){for(var s=(0,i.sc)(2,4),c=(0,i.sc)(4,5),d=0;d<c;d++)for(var g=-s;g<=s;g++){var m=(0,i.Yy)(n,e+g,t+d),y=Math.abs(g)==s||0==d||d==c-1;a[m]=y?"interiorwall":"inner",o[m]="interiorwall"}var h=(0,i.sc)(2,2*s-1);for(g=0;g<h;g++){var v=(0,i.sc)(e-s,e+s);if("inner"==a[m=(0,i.Yy)(n,v,t+c-2)]||"interiorwall"==a[m]||"air"==a[m]){var f=u(v,t+c-2,m);a[m]=f.image,"assembler_b"==a[m]&&(a[(0,i.Yy)(n,v,t+c-3)]="assembler_t"),"blast_b"==a[m]&&(a[(0,i.Yy)(n,v,t+c-3)]="blast_t"),"stone_br"==a[m]&&(a[(0,i.Yy)(n,v,t+c-3)]="stone_tr",a[(0,i.Yy)(n,v-1,t+c-3)]="stone_tl",a[(0,i.Yy)(n,v-1,t+c-2)]="stone_bl"),f.cargo&&l.push(f)}}}function m(e,t,r,n,i,a){"armor"!=n[i]&&"interiorwall"!=n[i]&&"sky"!=n[i]&&"cargo"!=n[i]||(("cargo"==n[i]||"cargo"==r[i]||r[i].startsWith("conv"))&&(a="cargo"),r[i]="armor"==n[i]?"cargo":a)}function y(e,t,r,n,a,o){for(var l=Math.min(a.x,o.x)+1;l<Math.max(a.x,o.x);l++)m(0,0,r,n,(0,i.Yy)(t,l,a.y),"conv_h");for(l=Math.min(a.y,o.y)+1;l<Math.max(a.y,o.y);l++)m(0,0,r,n,(0,i.Yy)(t,o.x,l),"conv_v");var s;s=o.y<a.y?o.x<a.x?"convcorner-ur":"convcorner-ul":o.x<a.x?"convcorner-dr":"convcorner-dl",m(0,0,r,n,(0,i.Yy)(t,o.x,a.y),s)}function h(){if(a.M)return;let e=document.body,t=document.documentElement;var r=Math.max(e.offsetHeight,t.clientHeight,t.offsetHeight,window.innerHeight,document.body.clientHeight),n=Math.max(window.innerWidth,document.body.clientWidth);let u=Math.ceil(r/64),m=Math.ceil(n/64);console.log("Generating SE tileset with "+m+" columns and "+u+" rows");let h=new Array(m*u),v=new Array(m*u);for(var f=0;f<u;f++)for(var b=0;b<m;b++){var w=(0,i.Yy)(m,b,f);h[w]="sky",v[w]="air"}let x=[];for(f=0;f<.75*u;f++)g((0,i.sc)(4,m-4),(0,i.sc)(2,u-2),0,m,v,h,x);!function(e,t,r,n){for(var a=0;a<e;a++)for(var o=0;o<t;o++){var l=(0,i.Yy)(t,o,a);if("interiorwall"==r[l]){var s=(0,i.Yy)(t,o-1,a),c=(0,i.Yy)(t,o+1,a),d=(0,i.Yy)(t,o,a-1),u=(0,i.Yy)(t,o,a+1);if("interiorwall"==r[d]&&"interiorwall"==r[u]&&"inner"==r[s]&&"inner"==n[c]){var g=(0,i.Yy)(t,o-1,a+1),m=(0,i.Yy)(t,o+1,a+1);"interiorwall"==r[g]&&"interiorwall"==r[m]&&(r[l]="inner")}}}}(u,m,v,h),function(e,t,r,n){for(var a=0;a<e;a++)for(var o=0;o<t;o++){var l=(0,i.Yy)(t,o,a);if("sky"==n[l]){var s=(0,i.Yy)(t,o-1,a),c=(0,i.Yy)(t,o+1,a),d=(0,i.Yy)(t,o,a-1),u=(0,i.Yy)(t,o,a+1);"interiorwall"!=n[d]&&"interiorwall"!=n[u]&&"interiorwall"!=n[s]&&"interiorwall"!=n[c]||(n[l]="armor")}}}(u,m,0,h),function(e,t,r,n,a){for(var o=0;o<e;o++)for(var l=0;l<t;l++)Math.random()<.2&&"interiorwall"==n[s=(0,i.Yy)(t,l,o)]&&"inner"==r[s]&&"interiorwall"==r[(0,i.Yy)(t,l,o+1)]&&(n[s]="cargo");if(a.length>=2)for(l=0;l<Math.max(1,a.length/3);l++)y(0,t,r,n,a[(0,i.sc)(0,a.length-1)],a[(0,i.sc)(0,a.length-1)]);for(o=0;o<e;o++)for(l=0;l<t;l++){var s;"assembler_b"==r[s=(0,i.Yy)(t,l,o)]?r[(0,i.Yy)(t,l,o-1)]="assembler_t":"assembler_t"==r[s]&&(r[(0,i.Yy)(t,l,o+1)]="assembler_b"),"blast_b"==r[s]?r[(0,i.Yy)(t,l,o-1)]="blast_t":"blast_t"==r[s]&&(r[(0,i.Yy)(t,l,o+1)]="blast_b"),"stone_br"==r[s]&&(r[(0,i.Yy)(t,l,o-1)]="stone_tr",r[(0,i.Yy)(t,l-1,o-1)]="stone_tl",r[(0,i.Yy)(t,l-1,o)]="stone_bl")}}(u,m,v,h,x);let p="background-content",S=document.getElementById(p);for(null==S&&(S=document.createElement("div"),S.id=p,console.log("Injecting background element."),document.body.prepend(S));S.firstChild;)S.removeChild(S.firstChild);let Y=document.createElementNS(i.DI,"svg");var _;for(Y.setAttributeNS(null,"width",n.toString()),Y.setAttributeNS(null,"height",r.toString()),Y.id="skybox-layer",i.hm&&((_=document.createElementNS("http://www.w3.org/2000/svg","image")).setAttributeNS(null,i.yJ,"320"),_.setAttributeNS(null,i.eT,"320"),_.setAttributeNS("http://www.w3.org/1999/xlink","href",(0,i.Fq)("xmas","se")),_.setAttributeNS(null,i.HP,(0,i.sc)(32,n-350).toString()),_.setAttributeNS(null,i.rR,(0,i.sc)(32,n-350).toString()),_.setAttributeNS(null,i.pX,i.yK),Y.appendChild(_)),i.Jt&&((_=document.createElementNS("http://www.w3.org/2000/svg","image")).setAttributeNS(null,i.yJ,"320"),_.setAttributeNS(null,i.eT,"320"),_.setAttributeNS("http://www.w3.org/1999/xlink","href",(0,i.Fq)("hallow","se")),_.setAttributeNS(null,i.HP,(0,i.sc)(32,n-350).toString()),_.setAttributeNS(null,i.rR,(0,i.sc)(32,n-350).toString()),_.setAttributeNS(null,i.pX,i.yK),Y.appendChild(_)),b=0;b<n;b+=o)for(f=0;f<r;f+=o)s(Y,"starfield",b,f,o,o);S.appendChild(Y);let N=document.createElement("div");N.style.position="absolute",N.id="block-layer",N.className="tile-layer",S.appendChild(N),S.style.width=n.toString()+"px",S.style.height=r.toString()+"px",function(e,t,r,n,a,o,s){for(var u=0;u<t;u++){let t=document.createElement("div");for(var g=0;g<r;g++){var m=(0,i.Yy)(r,g,u),y=n[m];let e=t,o=!1;if(c(y)&&"sky"!=a[m]&&(e=l(e,d(g,u,a[m])),o=!0),"air"!=y&&("sky"!=a[m]&&(e=l(e,"inner")),"inner"!=y&&(e=l(e,y=d(g,u,y))),o=!0),(0,i.w7)(),e==t){let t=document.createElement("div");t.style.width=64..toString()+"px",t.style.height=64..toString()+"px",e.appendChild(t)}}e.appendChild(t)}(0,i.xE)(e,1)}(N,u,m,v,h)}window.addEventListener("resize",(0,n.D)(h,100))}}]);
//# sourceMappingURL=984.bundle.js.map