(self.webpackChunksitecore=self.webpackChunksitecore||[]).push([[984],{984:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var n=r(621),a=r(212);const i=2e3;function o(e,t){let r=document.createElement("div");return r.className="tile-se-"+t,e.appendChild(r),r}function l(e,t,r,a,i,o){t=c(r,a,t);var l=document.createElementNS("http://www.w3.org/2000/svg","image");l.setAttributeNS(null,n.yJ,i.toString()),l.setAttributeNS(null,n.eT,o.toString()),l.setAttributeNS("http://www.w3.org/1999/xlink","href",(0,n.Fq)(t,"se")),l.setAttributeNS(null,n.HP,r.toString()),l.setAttributeNS(null,n.rR,a.toString()),l.setAttributeNS(null,n.pX,n.yK),e.appendChild(l)}function s(e){switch(e){case"air":case"gravgen":case"conv_v":case"conv_h":case"convcorner-dl":case"convcorner-ul":case"convcorner-dr":case"convcorner-ur":case"prog":case"inner":return!0;default:return!1}}function c(e,t,r){return"armor"==r?(n.hm&&(r=Math.cos(.25*e)+.43*Math.cos(.75*e)-.72*Math.sin(.47*t)>0?"armor_green":"armor_red"),n.Jt&&(r=Math.cos(.25*e)+.43*Math.cos(.75*e)-.72*Math.sin(.47*t)>0?"armor_black":"armor_orange")):"conv_h"==r&&Math.random()<.05&&(r=Math.random()<.5?"sorter-l":"sorter-r"),r}function d(e,t,r){var n=1.5*Math.random();return n<.05?{image:"gravgen",cargo:!1,x:e,y:t,index:r,sides:["l","r","u","d"]}:n<.15?{image:"assembler_b",cargo:!0,x:e,y:t,index:r,sides:["l","r","d"]}:n<.25?{image:"timer",cargo:!1,x:e,y:t,index:r,sides:["l","r","u","d"]}:n<.4?{image:"battery",cargo:!1,x:e,y:t,index:r,sides:["l","r","u","d"]}:n<.5?{image:"prog",cargo:!1,x:e,y:t,index:r,sides:["l","r","u","d"]}:n<.75?{image:"catwalk",cargo:!1,x:e,y:t,index:r,sides:["l","r","u","d"]}:n<.8?{image:"door",cargo:!1,x:e,y:t,index:r,sides:["l","r","u","d"]}:n<.9?{image:"cent",cargo:!0,x:e,y:t,index:r,sides:["u","d"]}:n<1.1?{image:"blast_b",cargo:!0,x:e,y:t,index:r,sides:["d"]}:n<1.3?{image:"stone_br",cargo:!0,x:e,y:t,index:r,sides:["d","r"]}:{image:"cargo",cargo:!0,x:e,y:t,index:r,sides:["l","r","u","d"]}}function u(e,t,r,a,i,o,l){for(var s=(0,n.sc)(2,4),c=(0,n.sc)(4,5),u=0;u<c;u++)for(var g=-s;g<=s;g++){var y=(0,n.Yy)(a,e+g,t+u),m=Math.abs(g)==s||0==u||u==c-1;i[y]=m?"interiorwall":"inner",o[y]="interiorwall"}var h=(0,n.sc)(2,2*s-1);for(g=0;g<h;g++){var b=(0,n.sc)(e-s,e+s);if("inner"==i[y=(0,n.Yy)(a,b,t+c-2)]||"interiorwall"==i[y]||"air"==i[y]){var v=d(b,t+c-2,y);i[y]=v.image,"assembler_b"==i[y]&&(i[(0,n.Yy)(a,b,t+c-3)]="assembler_t"),"blast_b"==i[y]&&(i[(0,n.Yy)(a,b,t+c-3)]="blast_t"),"stone_br"==i[y]&&(i[(0,n.Yy)(a,b,t+c-3)]="stone_tr",i[(0,n.Yy)(a,b-1,t+c-3)]="stone_tl",i[(0,n.Yy)(a,b-1,t+c-2)]="stone_bl"),v.cargo&&l.push(v)}}}function g(e,t,r,n,a,i){"armor"!=n[a]&&"interiorwall"!=n[a]&&"sky"!=n[a]&&"cargo"!=n[a]||(("cargo"==n[a]||"cargo"==r[a]||r[a].startsWith("conv"))&&(i="cargo"),r[a]="armor"==n[a]?"cargo":i)}function y(e,t,r,a,i,o){for(var l=Math.min(i.x,o.x)+1;l<Math.max(i.x,o.x);l++)g(0,0,r,a,(0,n.Yy)(t,l,i.y),"conv_h");for(l=Math.min(i.y,o.y)+1;l<Math.max(i.y,o.y);l++)g(0,0,r,a,(0,n.Yy)(t,o.x,l),"conv_v");var s;s=o.y<i.y?o.x<i.x?"convcorner-ur":"convcorner-ul":o.x<i.x?"convcorner-dr":"convcorner-dl",g(0,0,r,a,(0,n.Yy)(t,o.x,i.y),s)}function m(){if(a.M)return;document.body,document.documentElement;var e=document.body.offsetHeight,t=Math.max(window.innerWidth,document.body.clientWidth);let r=Math.ceil(e/64),d=Math.ceil(t/64);console.log("Generating SE tileset with "+d+" columns and "+r+" rows");let g=new Array(d*r),m=new Array(d*r);for(var h=0;h<r;h++)for(var b=0;b<d;b++){var v=(0,n.Yy)(d,b,h);g[v]="sky",m[v]="air"}let f=[];for(h=0;h<.75*r;h++)u((0,n.sc)(4,d-4),(0,n.sc)(2,r-2),0,d,m,g,f);!function(e,t,r,a){for(var i=0;i<e;i++)for(var o=0;o<t;o++){var l=(0,n.Yy)(t,o,i);if("interiorwall"==r[l]){var s=(0,n.Yy)(t,o-1,i),c=(0,n.Yy)(t,o+1,i),d=(0,n.Yy)(t,o,i-1),u=(0,n.Yy)(t,o,i+1);if("interiorwall"==r[d]&&"interiorwall"==r[u]&&"inner"==r[s]&&"inner"==a[c]){var g=(0,n.Yy)(t,o-1,i+1),y=(0,n.Yy)(t,o+1,i+1);"interiorwall"==r[g]&&"interiorwall"==r[y]&&(r[l]="inner")}}}}(r,d,m,g),function(e,t,r,a){for(var i=0;i<e;i++)for(var o=0;o<t;o++){var l=(0,n.Yy)(t,o,i);if("sky"==a[l]){var s=(0,n.Yy)(t,o-1,i),c=(0,n.Yy)(t,o+1,i),d=(0,n.Yy)(t,o,i-1),u=(0,n.Yy)(t,o,i+1);"interiorwall"!=a[d]&&"interiorwall"!=a[u]&&"interiorwall"!=a[s]&&"interiorwall"!=a[c]||(a[l]="armor")}}}(r,d,0,g),function(e,t,r,a,i){for(var o=0;o<e;o++)for(var l=0;l<t;l++)Math.random()<.2&&"interiorwall"==a[s=(0,n.Yy)(t,l,o)]&&"inner"==r[s]&&"interiorwall"==r[(0,n.Yy)(t,l,o+1)]&&(a[s]="cargo");if(i.length>=2)for(l=0;l<Math.max(1,i.length/3);l++)y(0,t,r,a,i[(0,n.sc)(0,i.length-1)],i[(0,n.sc)(0,i.length-1)]);for(o=0;o<e;o++)for(l=0;l<t;l++){var s;"assembler_b"==r[s=(0,n.Yy)(t,l,o)]?r[(0,n.Yy)(t,l,o-1)]="assembler_t":"assembler_t"==r[s]&&(r[(0,n.Yy)(t,l,o+1)]="assembler_b"),"blast_b"==r[s]?r[(0,n.Yy)(t,l,o-1)]="blast_t":"blast_t"==r[s]&&(r[(0,n.Yy)(t,l,o+1)]="blast_b"),"stone_br"==r[s]&&(r[(0,n.Yy)(t,l,o-1)]="stone_tr",r[(0,n.Yy)(t,l-1,o-1)]="stone_tl",r[(0,n.Yy)(t,l-1,o)]="stone_bl")}}(r,d,m,g,f);let w="background-content",x=document.getElementById(w);for(null==x&&(x=document.createElement("div"),x.id=w,console.log("Injecting background element."),document.getElementById("main-scroller").prepend(x));x.firstChild;)x.removeChild(x.firstChild);let S=document.createElementNS(n.DI,"svg");var p;for(S.setAttributeNS(null,"width",t.toString()),S.setAttributeNS(null,"height",e.toString()),S.id="skybox-layer",n.hm&&((p=document.createElementNS("http://www.w3.org/2000/svg","image")).setAttributeNS(null,n.yJ,"320"),p.setAttributeNS(null,n.eT,"320"),p.setAttributeNS("http://www.w3.org/1999/xlink","href",(0,n.Fq)("xmas","se")),p.setAttributeNS(null,n.HP,(0,n.sc)(32,t-350).toString()),p.setAttributeNS(null,n.rR,(0,n.sc)(32,t-350).toString()),p.setAttributeNS(null,n.pX,n.yK),S.appendChild(p)),n.Jt&&((p=document.createElementNS("http://www.w3.org/2000/svg","image")).setAttributeNS(null,n.yJ,"320"),p.setAttributeNS(null,n.eT,"320"),p.setAttributeNS("http://www.w3.org/1999/xlink","href",(0,n.Fq)("hallow","se")),p.setAttributeNS(null,n.HP,(0,n.sc)(32,t-350).toString()),p.setAttributeNS(null,n.rR,(0,n.sc)(32,t-350).toString()),p.setAttributeNS(null,n.pX,n.yK),S.appendChild(p)),b=0;b<t;b+=i)for(h=0;h<e;h+=i)l(S,"starfield",b,h,i,i);x.appendChild(S);let Y=document.createElement("div");Y.style.position="absolute",Y.id="block-layer",Y.className="tile-layer",x.appendChild(Y),function(e,t,r,a,i,l,d){for(var u=0;u<t;u++){let t=document.createElement("div");for(var g=0;g<r;g++){var y=(0,n.Yy)(r,g,u),m=a[y];let e=t,l=!1;if(s(m)&&"sky"!=i[y]&&(e=o(e,c(g,u,i[y])),l=!0),"air"!=m&&("sky"!=i[y]&&(e=o(e,"inner")),"inner"!=m&&(e=o(e,m=c(g,u,m))),l=!0),(0,n.w7)(),e==t){let t=document.createElement("div");t.style.width=64..toString()+"px",t.style.height=64..toString()+"px",e.appendChild(t)}}e.appendChild(t)}(0,n.xE)(e,1)}(Y,r,d,m,g)}}}]);
//# sourceMappingURL=984.bundle.js.map