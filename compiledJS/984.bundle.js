(self.webpackChunksitecore=self.webpackChunksitecore||[]).push([[984],{984:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>m});var n=r(621),i=r(212);const a=2e3;function o(t,e){let r=document.createElement("div");return r.className="tile-se-"+e,t.appendChild(r),r}function l(t,e,r,i,a,o){e=c(r,i,e);var l=document.createElementNS("http://www.w3.org/2000/svg","image");l.setAttributeNS(null,n.yJ,a.toString()),l.setAttributeNS(null,n.eT,o.toString()),l.setAttributeNS("http://www.w3.org/1999/xlink","href",(0,n.Fq)(e,"se")),l.setAttributeNS(null,n.HP,r.toString()),l.setAttributeNS(null,n.rR,i.toString()),l.setAttributeNS(null,n.pX,n.yK),t.appendChild(l)}function s(t){switch(t){case"air":case"gravgen":case"conv_v":case"conv_h":case"convcorner-dl":case"convcorner-ul":case"convcorner-dr":case"convcorner-ur":case"prog":case"inner":return!0;default:return!1}}function c(t,e,r){return"armor"==r?(n.hm&&(r=Math.cos(.25*t)+.43*Math.cos(.75*t)-.72*Math.sin(.47*e)>0?"armor_green":"armor_red"),n.Jt&&(r=Math.cos(.25*t)+.43*Math.cos(.75*t)-.72*Math.sin(.47*e)>0?"armor_black":"armor_orange")):"conv_h"==r&&Math.random()<.05&&(r=Math.random()<.5?"sorter-l":"sorter-r"),r}function d(t,e,r){var n=1.5*Math.random();return n<.05?{image:"gravgen",cargo:!1,x:t,y:e,index:r,sides:["l","r","u","d"]}:n<.15?{image:"assembler_b",cargo:!0,x:t,y:e,index:r,sides:["l","r","d"]}:n<.25?{image:"timer",cargo:!1,x:t,y:e,index:r,sides:["l","r","u","d"]}:n<.4?{image:"battery",cargo:!1,x:t,y:e,index:r,sides:["l","r","u","d"]}:n<.5?{image:"prog",cargo:!1,x:t,y:e,index:r,sides:["l","r","u","d"]}:n<.75?{image:"catwalk",cargo:!1,x:t,y:e,index:r,sides:["l","r","u","d"]}:n<.8?{image:"door",cargo:!1,x:t,y:e,index:r,sides:["l","r","u","d"]}:n<.9?{image:"cent",cargo:!0,x:t,y:e,index:r,sides:["u","d"]}:n<1.1?{image:"blast_b",cargo:!0,x:t,y:e,index:r,sides:["d"]}:n<1.3?{image:"stone_br",cargo:!0,x:t,y:e,index:r,sides:["d","r"]}:{image:"cargo",cargo:!0,x:t,y:e,index:r,sides:["l","r","u","d"]}}function u(t,e,r,i,a,o,l){for(var s=(0,n.sc)(2,4),c=(0,n.sc)(4,5),u=0;u<c;u++)for(var y=-s;y<=s;y++){var g=(0,n.Yy)(i,r,t+y,e+u),m=Math.abs(y)==s||0==u||u==c-1;a[g]=m?"interiorwall":"inner",o[g]="interiorwall"}var h=(0,n.sc)(2,2*s-1);for(y=0;y<h;y++){var v=(0,n.sc)(t-s,t+s);if("inner"==a[g=(0,n.Yy)(i,r,v,e+c-2)]||"interiorwall"==a[g]||"air"==a[g]){var b=d(v,e+c-2,g);a[g]=b.image,"assembler_b"==a[g]&&(a[(0,n.Yy)(i,r,v,e+c-3)]="assembler_t"),"blast_b"==a[g]&&(a[(0,n.Yy)(i,r,v,e+c-3)]="blast_t"),"stone_br"==a[g]&&(a[(0,n.Yy)(i,r,v,e+c-3)]="stone_tr",a[(0,n.Yy)(i,r,v-1,e+c-3)]="stone_tl",a[(0,n.Yy)(i,r,v-1,e+c-2)]="stone_bl"),b.cargo&&l.push(b)}}}function y(t,e,r,n,i,a){"armor"!=n[i]&&"interiorwall"!=n[i]&&"sky"!=n[i]&&"cargo"!=n[i]||(("cargo"==n[i]||"cargo"==r[i]||r[i].startsWith("conv"))&&(a="cargo"),r[i]="armor"==n[i]?"cargo":a)}function g(t,e,r,i,a,o){for(var l=Math.min(a.x,o.x)+1;l<Math.max(a.x,o.x);l++)y(0,0,r,i,(0,n.Yy)(e,t,l,a.y),"conv_h");for(l=Math.min(a.y,o.y)+1;l<Math.max(a.y,o.y);l++)y(0,0,r,i,(0,n.Yy)(e,t,o.x,l),"conv_v");var s;s=o.y<a.y?o.x<a.x?"convcorner-ur":"convcorner-ul":o.x<a.x?"convcorner-dr":"convcorner-dl",y(0,0,r,i,(0,n.Yy)(e,t,o.x,a.y),s)}function m(){if(i.M)return;document.body,document.documentElement;var t=document.body.offsetHeight,e=Math.max(window.innerWidth,document.body.clientWidth);let r=Math.ceil(t/64),d=Math.ceil(e/64);console.log("Generating SE tileset with "+d+" columns and "+r+" rows");let y=new Array(d*r),m=new Array(d*r);for(var h=0;h<r;h++)for(var v=0;v<d;v++){var b=(0,n.Yy)(d,r,v,h);y[b]="sky",m[b]="air"}let f=[];for(h=0;h<.75*r;h++)u((0,n.sc)(4,d-4),(0,n.sc)(2,r-2),r,d,m,y,f);!function(t,e,r,i){for(var a=0;a<t;a++)for(var o=0;o<e;o++){var l=(0,n.Yy)(e,t,o,a);if("interiorwall"==r[l]){var s=(0,n.Yy)(e,t,o-1,a),c=(0,n.Yy)(e,t,o+1,a),d=(0,n.Yy)(e,t,o,a-1),u=(0,n.Yy)(e,t,o,a+1);if("interiorwall"==r[d]&&"interiorwall"==r[u]&&"inner"==r[s]&&"inner"==i[c]){var y=(0,n.Yy)(e,t,o-1,a+1),g=(0,n.Yy)(e,t,o+1,a+1);"interiorwall"==r[y]&&"interiorwall"==r[g]&&(r[l]="inner")}}}}(r,d,m,y),function(t,e,r,i){for(var a=0;a<t;a++)for(var o=0;o<e;o++){var l=(0,n.Yy)(e,t,o,a);if("sky"==i[l]){var s=(0,n.Yy)(e,t,o-1,a),c=(0,n.Yy)(e,t,o+1,a),d=(0,n.Yy)(e,t,o,a-1),u=(0,n.Yy)(e,t,o,a+1);"interiorwall"!=i[d]&&"interiorwall"!=i[u]&&"interiorwall"!=i[s]&&"interiorwall"!=i[c]||(i[l]="armor")}}}(r,d,0,y),function(t,e,r,i,a){for(var o=0;o<t;o++)for(var l=0;l<e;l++)Math.random()<.2&&"interiorwall"==i[s=(0,n.Yy)(e,t,l,o)]&&"inner"==r[s]&&"interiorwall"==r[(0,n.Yy)(e,t,l,o+1)]&&(i[s]="cargo");if(a.length>=2)for(l=0;l<Math.max(1,a.length/3);l++)g(t,e,r,i,a[(0,n.sc)(0,a.length-1)],a[(0,n.sc)(0,a.length-1)]);for(o=0;o<t;o++)for(l=0;l<e;l++){var s;"assembler_b"==r[s=(0,n.Yy)(e,t,l,o)]?r[(0,n.Yy)(e,t,l,o-1)]="assembler_t":"assembler_t"==r[s]&&(r[(0,n.Yy)(e,t,l,o+1)]="assembler_b"),"blast_b"==r[s]?r[(0,n.Yy)(e,t,l,o-1)]="blast_t":"blast_t"==r[s]&&(r[(0,n.Yy)(e,t,l,o+1)]="blast_b"),"stone_br"==r[s]&&(r[(0,n.Yy)(e,t,l,o-1)]="stone_tr",r[(0,n.Yy)(e,t,l-1,o-1)]="stone_tl",r[(0,n.Yy)(e,t,l-1,o)]="stone_bl")}}(r,d,m,y,f);let w="background-content",x=document.getElementById(w);for(null==x&&(x=document.createElement("div"),x.id=w,console.log("Injecting background element."),document.body.prepend(x));x.firstChild;)x.removeChild(x.firstChild);let p=document.createElementNS(n.DI,"svg");for(p.setAttributeNS(null,"width",e.toString()),p.setAttributeNS(null,"height",t.toString()),p.id="skybox-layer",p.style.position="relative",p.style.left="0px",p.style.top="0px",v=0;v<e;v+=a)for(h=0;h<t;h+=a)l(p,"starfield",v,h,a,a);var S;n.hm&&((S=document.createElementNS("http://www.w3.org/2000/svg","image")).setAttributeNS(null,n.yJ,"320"),S.setAttributeNS(null,n.eT,"320"),S.setAttributeNS("http://www.w3.org/1999/xlink","href",(0,n.Fq)("xmas","se")),S.setAttributeNS(null,n.HP,(0,n.sc)(32,e-350).toString()),S.setAttributeNS(null,n.rR,(0,n.sc)(32,e-350).toString()),S.setAttributeNS(null,n.pX,n.yK),p.appendChild(S)),n.Jt&&((S=document.createElementNS("http://www.w3.org/2000/svg","image")).setAttributeNS(null,n.yJ,"320"),S.setAttributeNS(null,n.eT,"320"),S.setAttributeNS("http://www.w3.org/1999/xlink","href",(0,n.Fq)("hallow","se")),S.setAttributeNS(null,n.HP,(0,n.sc)(32,e-350).toString()),S.setAttributeNS(null,n.rR,(0,n.sc)(32,e-350).toString()),S.setAttributeNS(null,n.pX,n.yK),p.appendChild(S)),x.appendChild(p);let Y=document.createElement("div");Y.style.position="relative",Y.id="block-layer",Y.className="tile-layer",Y.style.left="0px",Y.style.top="0px",Y.style.width=e.toString()+"px",Y.style.height=t.toString()+"px",x.appendChild(Y),function(t,e,r,i,a,l,d){for(var u=0;u<e;u++){let l=document.createElement("div");for(var y=0;y<r;y++){var g=(0,n.Yy)(r,e,y,u),m=i[g];let t=l,d=!1;if(s(m)&&"sky"!=a[g]&&(t=o(t,c(y,u,a[g])),d=!0),"air"!=m&&("sky"!=a[g]&&(t=o(t,"inner")),"inner"!=m&&(t=o(t,m=c(y,u,m))),d=!0),(0,n.w7)(),t==l){let e=document.createElement("div");e.style.width=64..toString()+"px",e.style.height=64..toString()+"px",t.appendChild(e)}}t.appendChild(l)}(0,n.xE)(t,1)}(Y,r,d,m,y)}}}]);
//# sourceMappingURL=984.bundle.js.map